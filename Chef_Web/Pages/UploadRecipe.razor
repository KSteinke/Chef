@page "/UploadRecipe"
@using Chef_Models.Dtos;
@using Chef_Web.Services.Contracts;
@*@attribute [Authorize]*@



<div class="container-fluid">
    <div class="row text-center">
        <div class="col">
            <img src="/assets/addRecipeImage.jpg" alt="Add Recipe" width="250" class="border-secondary"/>
        </div>
    </div>
</div>
<div class="container-fluid border-secondary my-1 w-50 align-content-center"
    <div class="row text-center ">
        <div class="col" >
            <div class="form-group my-1" >
                <label for="formFile" class="form-label mt-4">Default file input example</label>
                <input class="form-control" type="file" id="formFile">
            </div>
        </div>
    </div>
</div>
<div class="container-fluid border-secondary my-1 w-50 align-content-center"
    <div class="row text-center ">
        <div class="col my-1">
            <h3>List of ingredients</h3>
            <ul class="list-group">
              @if(AddedIngredients != null)
                {
                    @foreach (var ingredient in AddedIngredients)
                    {
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                              <div class="col justify-content-center">
                                @ingredient.Name
                              </div>
                              <div class="col justify-content-end">
                                  <span class="badge bg-primary rounded-pill">@ingredient.Quantity </span>
                                  <span class="badge bg-danger rounded-pill" @onclick="() => DeleteIngredient(ingredient)">X</span>
                              </div>
                          </li>
                    }
                }
                
            </ul>
        </div>
    </div>
</div>
<div class="container-fluid border-secondary my-1 w-50 align-content-center align-items-center justify-content-center text-center">
    <div class="row text-center align-content-center">
        <div class="col my-1">
            <div class="form-group" >
                <label for="exampleSelect1" class="form-label mt-3">Add ingredients to your recipe</label>
                <select class="form-select" id="exampleSelect1" @bind="IngredientToAdd.Id"> 
                    @foreach(var ingredient in AvailableIngridients)
                    {
                        <option value="@ingredient.Id">@ingredient.Name</option>
                    }
                </select>
            </div>
        </div>
        <div class="col my-1">
            <div class="form-group">
                <label class="col-form-label " for="inputDefault">Default input</label>
                <input type="text" class="form-control" placeholder="Default input" id="inputDefault">
            </div>
        </div>
        <div class="col my-1 mt-5">
            <button type="button" class="btn btn-secondary btn-outline-dark" @onclick="() => AddIngredient(IngredientToAdd)">Add Ingredient</button>
        </div>
    </div>
</div>

@code {
    [Inject]
    public IIngredientService _ingredientService { get; set; }

    public List<IngredientDto> AddedIngredients { get; set; }
    public List<IngredientDto> AvailableIngridients { get; set; }
    public IngredientDto IngredientToAdd { get; set; }
    

    protected override Task OnInitializedAsync()
    {
        AvailableIngridients = _ingredientService.GetIngredients();

        return Task.CompletedTask;
    }

    public void DeleteIngredient(IngredientDto addedIngredient)
    {
        AddedIngredients.Remove(addedIngredient);
    }

    public void AddIngredient(IngredientDto ingredientToAdd)
    {

        //AddedIngredients.Add(ingredientToAdd);
    }

}
